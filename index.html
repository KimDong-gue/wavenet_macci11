<!DOCTYPE html>

<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      요기요_멕시카나치킨 할인 마케팅 통합 성과 리포트 (Interactive)
    </title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.26.0/plotly.min.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Noto Sans KR", sans-serif;
        line-height: 1.8;
        color: #2c3e50;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 20px;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: white;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        border-radius: 20px;
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        color: white;
        padding: 60px 40px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        animation: pulse 15s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }

      .header h1 {
        font-size: 2.5em;
        font-weight: 700;
        margin-bottom: 15px;
        position: relative;
        z-index: 1;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      .header .header-info {
        font-size: 1.1em;
        opacity: 0.95;
        position: relative;
        z-index: 1;
        margin-top: 10px;
      }

      .header .header-info p {
        margin: 5px 0;
      }

      .content {
        padding: 40px;
      }

      .executive-summary {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        padding: 40px;
        border-radius: 12px;
        margin-bottom: 50px;
        box-shadow: 0 6px 20px rgba(245, 87, 108, 0.3);
      }

      .executive-summary h2 {
        font-size: 1.8em;
        margin-bottom: 25px;
        font-weight: 600;
      }

      .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 25px;
      }

      .summary-card {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        padding: 25px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .summary-card h3 {
        font-size: 1.1em;
        margin-bottom: 12px;
        font-weight: 600;
      }

      .summary-card p {
        font-size: 0.95em;
        line-height: 1.7;
      }

      .toc {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 40px;
        border-left: 5px solid #e74c3c;
      }

      .toc h2 {
        color: #e74c3c;
        margin-bottom: 20px;
        font-size: 1.8em;
        padding-bottom: 0;
        border-bottom: none;
        margin-top: 0;
      }

      .toc ol {
        list-style: decimal;
        margin-left: 25px;
      }

      .toc ol li {
        padding: 10px 0;
        border-bottom: 1px solid #e9ecef;
      }

      .toc ol li:last-child {
        border-bottom: none;
      }

      .toc ol a {
        color: #495057;
        text-decoration: none;
        transition: all 0.3s;
        padding: 5px 10px;
        border-radius: 8px;
        display: inline-block;
      }

      .toc ol a:hover {
        background: #e74c3c;
        color: white;
        transform: translateX(10px);
      }

      .section {
        margin-bottom: 60px;
        scroll-margin-top: 20px;
      }

      .section h2 {
        color: #2c3e50;
        font-size: 1.8em;
        margin-bottom: 30px;
        padding-bottom: 15px;
        border-bottom: 3px solid #667eea;
        font-weight: 600;
      }

      .section h3 {
        color: #764ba2;
        font-size: 1.3em;
        margin: 30px 0 20px;
        font-weight: 600;
      }

      .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
        margin: 30px 0;
      }

      .metric-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        transition: transform 0.3s;
      }

      .metric-card:hover {
        transform: translateY(-5px);
      }

      .metric-label {
        font-size: 0.9em;
        opacity: 0.9;
        margin-bottom: 10px;
      }

      .metric-value {
        font-size: 2.2em;
        font-weight: 700;
        margin-bottom: 5px;
      }

      .metric-subtitle {
        font-size: 0.85em;
        opacity: 0.8;
      }

      .insight-box {
        background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
        border-left: 5px solid #00acc1;
        padding: 30px;
        margin: 30px 0;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 172, 193, 0.15);
      }

      .insight-box h4 {
        color: #00838f;
        font-size: 1.1em;
        margin-bottom: 12px;
        font-weight: 600;
      }

      .insight-box p {
        color: #006064;
        margin-bottom: 12px;
        line-height: 1.8;
      }

      .strategy-box {
        background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
        border-left: 5px solid #ff6f00;
        padding: 30px;
        margin: 30px 0;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(255, 111, 0, 0.15);
      }

      .strategy-box h3 {
        color: #e65100;
        font-size: 1.3em;
        margin-bottom: 20px;
        font-weight: 600;
      }

      .strategy-box ul {
        list-style: none;
        padding-left: 0;
      }

      .strategy-box li {
        padding-left: 30px;
        position: relative;
        margin-bottom: 15px;
        color: #bf360c;
        line-height: 1.8;
      }

      .strategy-box li::before {
        content: "▸";
        position: absolute;
        left: 10px;
        color: #ff6f00;
        font-weight: 700;
      }

      .footer {
        text-align: center;
        margin-top: 50px;
        padding-top: 30px;
        border-top: 2px solid #e9ecef;
        color: #7f8c8d;
      }

      .footer p {
        margin: 5px 0;
      }

      .chart-container {
        margin: 30px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        min-height: 400px;
      }

      .chart-container > div {
        min-height: 400px;
        width: 100%;
        display: block;
      }

      .plotly-graph-div,
      .plotly .svg-container,
      .plotly .main-svg {
        width: 100% !important;
        min-height: 400px !important;
      }

      table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin: 30px 0;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
      }

      thead {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      th {
        padding: 18px 15px;
        text-align: center;
        font-weight: 600;
        font-size: 0.95em;
      }

      td {
        padding: 15px;
        text-align: center;
        border-bottom: 1px solid #e0e0e0;
        font-size: 0.9em;
      }

      tbody tr {
        background: white;
        transition: background 0.3s;
      }

      tbody tr:hover {
        background: #f5f5f5;
      }

      .highlight {
        background: #fff3cd;
        padding: 2px 8px;
        border-radius: 4px;
        font-weight: 600;
        color: #856404;
      }

      .highlight-success {
        background: #d4edda;
        color: #155724;
      }

      .highlight-danger {
        background: #f8d7da;
        color: #721c24;
      }

      @media (max-width: 768px) {
        .header {
          padding: 40px 30px;
        }

        .header h1 {
          font-size: 1.8em;
        }

        .content {
          padding: 20px;
        }

        .metrics-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="header">
        <h1>🍗 요기요_멕시카나치킨 할인 캠페인<br />마케팅 통합 성과 리포트</h1>
        <div class="header-info">
          <p><strong>분석 기간:</strong> 2025년 캠페인 기준</p>
          <p>
            <strong>타겟:</strong> 20-39세 남녀, 수도권(서울·경기 포함) |
            <strong>총 발송:</strong> 41,998건 | <strong>총 클릭:</strong> 655건
            | <strong>평균 CTR:</strong> 1.56%
          </p>
        </div>
      </div>

      <div class="content">
        <div class="toc">
          <h2>📋 목차</h2>
          <ol>
            <li><a href="#summary">Executive Summary</a></li>
            <li><a href="#s1">전체 캠페인 성과 요약</a></li>
            <li><a href="#s2">주요 세그먼트 성과 비교</a></li>
            <li><a href="#s3">앱 카테고리별 성과 분석</a></li>
            <li><a href="#s4">상세 앱/플랫폼 CTR 분석</a></li>
            <li><a href="#s5">성연령별 성과 분석</a></li>
            <li><a href="#s6">관심사별 행동 패턴</a></li>
            <li><a href="#s7">음식/배달 앱 심층 분석</a></li>
            <li><a href="#s8">고객 세그먼트 세부분석</a></li>
            <li><a href="#s9">지역별 사용 행태 분석</a></li>
            <li><a href="#strategy">전략 제언</a></li>
          </ol>
        </div>

        <div class="section" id="summary">
          <h2>📊 요약 (Executive Summary)</h2>
          <div class="executive-summary">
            <h2>📝 Executive Summary</h2>
            <div class="summary-grid">
              <div class="summary-card">
                <h3>💡 What (핵심 성과)</h3>
                <p>
                  '요기요_멕시카나치킨 할인' 캠페인은
                  <strong>20-39세 남녀</strong> 및
                  <strong>수도권(서울, 경기 포함)</strong>을 핵심 타겟으로 총
                  41,998건의 메시지를 발송하여 655건의 클릭을 유도하였으며, 평균
                  CTR 1.56%를 달성했습니다. 이는 멕시카나치킨 브랜드의 할인
                  프로모션에 대한 사용자 반응을 나타내는 핵심 지표입니다.
                </p>
              </div>
              <div class="summary-card">
                <h3>🔍 Why (주요 원인 분석)</h3>
                <p>
                  <strong>20-39세 남녀 타겟</strong> 내에서 **남성 30-34세 (CTR
                  2.07%)**가 최고 성과를 기록하였으며, **여성 30-34세 (1.82%)**,
                  **남성 35-39세 (1.52%)** 등 20-39세 전 연령대에서 평균 대비
                  높은 반응률을 보였습니다.
                  <strong>수도권(경기 1.63%, 서울 1.45%)</strong> 타겟에서도
                  안정적인 성과를 기록하였으며, 특히 경기 지역이 서울보다 높은
                  CTR을 보였습니다.
                </p>
              </div>
              <div class="summary-card">
                <h3>🚀 So What (전략적 시사점)</h3>
                <p>
                  <strong>20-39세 남녀</strong> 중 특히 30대 세그먼트를 Primary
                  Target으로 설정하고,
                  <strong>수도권(서울, 경기)</strong> 지역에 집중하여 경쟁 배달
                  플랫폼 사용자(쿠팡이츠, 팔도감 등)에 대한 집중 타겟팅을 통해
                  예산 효율성을 극대화해야 합니다. 차별화된 쿠폰 전략 및 맞춤형
                  메시징을 적용하여 ROI를 향상시키는 것을 권장합니다.
                </p>
              </div>
            </div>
          </div>
        </div>

        <div class="section" id="s1">
          <h2>1️⃣ 전체 캠페인 성과 요약</h2>

          <div class="metrics-grid">
            <div class="metric-card">
              <div class="metric-label">총 발송 수</div>
              <div class="metric-value">41,998</div>
              <div class="metric-subtitle">건</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">총 클릭 수</div>
              <div class="metric-value">655</div>
              <div class="metric-subtitle">건</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">평균 CTR</div>
              <div class="metric-value">1.56%</div>
              <div class="metric-subtitle">성과 기준선</div>
            </div>
          </div>

          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              본 캠페인은 총 41,998건의 메시지를 발송하여 655건의 클릭을
              발생시켰으며, 평균 CTR 1.56%를 기록하였습니다. 이는 멕시카나치킨
              브랜드의 할인 프로모션에 대한 사용자 반응을 나타내는 핵심
              지표입니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              캠페인 평균 CTR 1.56%는 전반적인 마케팅 효율성을 나타내며, 이
              수치는 후속 세그먼트별 분석을 위한 성과 기준선(Benchmark)이
              됩니다. 2차 캠페인 등 세부 캠페인별 성과 차이는 타겟팅 로직,
              메시지 최적화, 발송 시점 등이 영향을 미쳤을 것으로 분석됩니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              향후 캠페인에서는 1.56%를 Baseline으로 설정하고,
              <strong>20-39세 남녀</strong> 및
              <strong>수도권(서울, 경기)</strong> 타겟에 대한 예산 집중 및
              맞춤형 메시징을 통해 CTR 상향을 도모해야 합니다. 특히 본 분석에서
              확인된 고효율 타겟(20-39세 내 30대 남성, 수도권 내 경기 지역, 경쟁
              배달 플랫폼 사용자 등)에 대한 우선 투자를 권장합니다.
            </p>
          </div>
        </div>

        <div class="section" id="s2">
          <h2>2️⃣ 주요 세그먼트 성과 비교</h2>

          <div class="chart-container">
            <div id="chart-s2" class="plotly-data"></div>
          </div>

          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              <strong>20-39세 남녀 타겟</strong> 내에서 **남성 30-34세**가 **CTR
              2.07%**로 최고 성과를 기록하였으며, 이는 캠페인 평균(1.56%) 대비
              **1.33배** 높은 수치입니다. **여성 30-34세 (1.82%)**와 **남성
              35-39세 (1.52%)**가 그 뒤를 이어 <strong>20-39세 타겟</strong> 내
              **30대 세그먼트**의 반응성이 높음을 확인했습니다. 반면, **20대
              초반 남성 (0.62%)**과 **여성 (0.77%)**은 평균 대비 낮은 성과를
              보였습니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              <strong>20-39세 타겟</strong> 내에서 30대 세그먼트의 높은 CTR은
              다음과 같은 요인으로 분석됩니다: (1) **가구 단위 소비 주체**로서
              구매력이 높고 가정 내 식사 결정권을 가진 경우가 많아 즉각적인 구매
              결정 가능, (2) **배달 서비스 이용 빈도**가 높아 할인 오퍼에 대한
              반응성이 높음. 20대 초반의 낮은 CTR은 상대적으로 낮은 소득 수준,
              다른 채널/음식 선호, 혹은 소액 주문 성향 등의 차이로 해석됩니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              <strong>20-39세 타겟</strong> 내 고성과군(**30대 남성, 30대
              여성**)에는 강력한 즉시 혜택(할인율 강화, 세트 메뉴 등)을 제공하여
              전환율을 극대화해야 합니다. 특히 30대 세그먼트에 전체 예산의 **40%
              이상**을 재배치하는 것을 권장합니다. 저성과군(20대 초반)에는
              타겟팅 제외를 고려하거나, 소량/저가 메뉴에 대한 혜택 형식·타이밍
              A/B 테스트를 모색해야 합니다.
            </p>
          </div>
        </div>

        <div class="section" id="s3">
          <h2>3️⃣ 앱 카테고리별 성과 분석</h2>

          <div class="chart-container">
            <div id="chart-s3" class="plotly-data"></div>
          </div>

          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              앱 카테고리별 성과 분석 결과, **Information (1.59%)**과
              **Communication (1.59%)** 카테고리 사용자 군이 캠페인 평균(1.56%)
              수준의 반응을 보였습니다. **Entertainment (1.58%)** 사용자 군 또한
              유사한 성과를 기록했습니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              CTR이 평균 수준으로 수렴하는 것은, 해당 앱들이 **대중적인 사용
              패턴**을 보이기 때문에 특정 앱 사용자의 구매 의향이 캠페인 성과에
              미치는 영향이 크지 않음을 시사합니다. 즉, 이 세그먼트는 **광범위한
              도달**을 위한 기본 타겟층으로 적합합니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              Information, Communication, Entertainment 카테고리 사용자에게는
              **도달률 확보**를 목표로 한 캠페인을 지속하되, 메시지를 **상황
              기반**으로 최적화하여 반응률을 제고해야 합니다. (예: Information
              앱 사용자에게는 신규 할인 소식 강조, Communication 앱 사용자에게는
              공유 유도 메시지 적용 등) 상세 앱/플랫폼 분석을 통해 발굴된 고효율
              앱 사용자에 대한 **교차 타겟팅**을 병행하여 효율을 높이는 전략이
              필요합니다.
            </p>
          </div>
        </div>

        <div class="section" id="s4">
          <h2>4️⃣ 상세 앱/플랫폼 CTR 분석</h2>

          <div class="chart-container">
            <div id="chart-s4" class="plotly-data"></div>
          </div>

          <table>
            <thead>
              <tr>
                <th>앱/플랫폼명</th>
                <th>발송 (Sent)</th>
                <th>클릭 (Click)</th>
                <th>CTR</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>쿠팡이츠(CoupangEats)</td>
                <td>12,856</td>
                <td>253</td>
                <td><span class="highlight">1.97%</span></td>
              </tr>
              <tr>
                <td>팔도감(Paldogam)</td>
                <td>11,768</td>
                <td>216</td>
                <td><span class="highlight">1.84%</span></td>
              </tr>
              <tr>
                <td>롯데잇츠(Lotteeatz)</td>
                <td>23,931</td>
                <td>426</td>
                <td><span class="highlight">1.78%</span></td>
              </tr>
              <tr>
                <td>배민상회(BaeminMart)</td>
                <td>12,002</td>
                <td>203</td>
                <td><span class="highlight">1.69%</span></td>
              </tr>
              <tr>
                <td>배달의민족(Baemin)</td>
                <td>38,925</td>
                <td>615</td>
                <td><span class="highlight">1.58%</span></td>
              </tr>
            </tbody>
          </table>

          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              음식/배달 앱 분석 결과, **쿠팡이츠 (CTR 1.97%)** 사용자가 가장
              높은 성과를 기록하였으며, 이는 캠페인 평균(1.56%) 대비 **1.26배**
              높은 수치입니다. **팔도감 (1.84%)**과 **롯데잇츠 (1.78%)** 사용자
              또한 평균 대비 높은 효율을 보였으며, 경쟁 배달 플랫폼 사용자들의
              높은 관심이 확인되었습니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              경쟁 배달 플랫폼 사용자(**쿠팡이츠, 팔도감, 롯데잇츠**)의 높은
              CTR은 다음과 같은 요인으로 해석됩니다: (1) **다중 플랫폼 이용
              경험**을 통한 할인 혜택 비교 습관, (2) **식품/식자재 구매 빈도**가
              높아 프로모션에 대한 관심도가 높음, (3) 플랫폼 **전환 의향**이
              있어 경쟁사 오퍼에 대한 반응성이 높음. 이들은 할인에 민감한
              **High-Value Cross-Targeting 세그먼트**로 분류됩니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              경쟁 배달 플랫폼 사용자에게는 '**쿠폰 비교**', '**최대 할인**' 등
              경쟁우위 문구를 강조하는 메시징(예: "타 플랫폼 대비 최대 할인율",
              "요기요 단독 특가")을 적용하여 **플랫폼 전환을 유도**해야 합니다.
              해당 앱 사용자 그룹에 대한 예산 비중을 높이는 것을 권장합니다.
            </p>
          </div>
        </div>

        <div class="section" id="s5">
          <h2>5️⃣ 성연령별 성과 분석</h2>

          <div class="chart-container">
            <div id="chart-s5" class="plotly-data"></div>
          </div>

          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              <strong>20-39세 남녀 타겟</strong> 내 성연령별 분석 결과, **남성
              30-34세 (CTR 2.07%)**가 가장 높은 성과를 기록하였으며, **여성
              30-34세 (1.82%)**와 **남성 35-39세 (1.52%)**가 그 뒤를 이었습니다.
              전반적으로 <strong>20-39세 타겟</strong> 내 **30대 세그먼트**의
              반응성이 높으며, 특히 **남성 30-34세**의 효율이 두드러집니다.
              **20대 초반** 세그먼트는 남녀 모두 평균 대비 낮은 성과를
              보였습니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              <strong>20-39세 타겟</strong> 내에서 고효율 세그먼트인 30대는
              **핵심 소비층**이며, (1) 구매력이 높고 (2) 가족 단위 식사 구매
              니즈가 높으며 (3) 배달 서비스 이용에 익숙한 **즉응형 반응**을
              보이는 것으로 분석됩니다. 20대 초반은 상대적으로 **프로모션
              민감도**가 낮거나, **치킨 외 다른 메뉴 선호** 경향이 있을 수
              있습니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              <strong>20-39세 타겟</strong> 내에서 **남성 30-34세**를 **Primary
              Target**으로 설정하고, 이들의 라이프스타일(예: 주말 가족 식사,
              야식)에 맞춘 **높은 할인율 및 세트 메뉴 제안**으로 전환율을
              극대화해야 합니다. 저성과군(20대 초반)에게 할당된 예산을 고효율
              세그먼트로 재배치하여 효율적인 집행을 도모해야 합니다.
            </p>
          </div>
        </div>

        <div class="section" id="s6">
          <h2>6️⃣ 관심사별 행동 패턴</h2>

          <div class="chart-container">
            <div id="chart-s6" class="plotly-data"></div>
          </div>

          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              관심사별 행동 패턴 분석 결과, **Communication (1.59%)**과
              **Information (1.59%)** 카테고리 사용자가 캠페인 평균(1.56%)
              수준의 CTR을 기록하였습니다. **Entertainment (1.58%)** 또한 유사한
              성과를 보였습니다. CTR이 높았던 Life 카테고리는 모수 부족으로
              분석에서 제외되었습니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              CTR이 평균 수준에 수렴하는 것은 이들이 **대부분의 사용자**를
              포괄하고 있어 **광범위한 도달**에는 효과적이나, **세밀한 구매 의향
              예측**에는 한계가 있음을 나타냅니다. 고효율 세그먼트인 음식/배달
              앱 사용자(Life 카테고리 하위)에 대한 집중 분석이 더 유의미합니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              대규모 카테고리는 **볼륨 확보**를 위한 기본 타겟으로 유지하되,
              **음식/배달 앱 사용자**와 같은 **고효율 교차 타겟** 세그먼트에
              대한 예산 비중을 높여 **마케팅 효율**을 집중해야 합니다.
            </p>
          </div>
        </div>

        <div class="section" id="s7">
          <h2>7️⃣ 음식/배달 앱 심층 분석</h2>
          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              음식/배달 앱 심층 분석 결과, **쿠팡이츠 (CTR 1.97%, Sent
              12,856건)** 사용자가 최상위를 기록하였으며, 이는 캠페인
              평균(1.56%) 대비 **1.26배** 높은 수치입니다. **팔도감 (1.84%, Sent
              11,768건)**, **롯데잇츠 (1.78%, Sent 23,931건)** 사용자도 높은
              효율을 보였습니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              경쟁 배달 플랫폼 사용자들의 높은 CTR은 (1) **활발한 플랫폼 비교 및
              할인 혜택 탐색** 성향을 가지며, (2) **배달 서비스에 대한 높은
              니즈**가 있음을 의미합니다. 이들은 **할인 프로모션**에 대한 **즉시
              반응성**이 매우 높은 **High-Value Cross-Targeting
              세그먼트**입니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              경쟁 배달 플랫폼 사용자 그룹을 **핵심 타겟**으로 설정하고,
              이들에게 '**플랫폼 전환**'을 유도하는 **강력한 메시지**와 **독점
              할인 혜택**을 집중적으로 제공해야 합니다. 자사 앱(**배달의민족**)
              사용자에게는 **재구매 유도** 및 **Lock-in** 전략을 수립하여
              LTV(Life Time Value)를 확보하는 방향으로 접근해야 합니다.
            </p>
          </div>

          <div class="chart-container">
            <div
              id="chart-s7"
              class="plotly-data"
              data-graph='{"data":[{"x":["쿠팡이츠(CoupangEats)","팔도감(Paldogam)","롯데잇츠(Lotteeatz)","배민상회(BaeminMart)","배달의민족(Baemin)","비비노(Vivino) Web"],"y":[1.9679527069072806,1.8354860639021073,1.7801178387865113,1.6913847692051325,1.579961464354528,1.5384615384615385],"type":"bar","marker":{"color":"#F77F00"},"text":["1.97%","1.84%","1.78%","1.69%","1.58%","1.54%"],"textposition":"outside","opacity":0.9}],"layout":{"title":{"text":"<b>음식/배달 앱별 CTR 심층분석 (Sent ≥ 100 기준)</b>","font":{"size":16}},"xaxis":{"tickangle":-35,"automargin":true},"yaxis":{"title":"CTR (%)","range":[0,3]},"plot_bgcolor":"#F8F9FA","paper_bgcolor":"white","autosize":true,"margin":{"t":50,"b":120},"shapes":[{"type":"line","xref":"paper","yref":"y","x0":0,"y0":1.56,"x1":1,"y1":1.56,"line":{"dash":"dash","color":"gray","width":2}}]}'
            ></div>
          </div>
        </div>

        <div class="section" id="s8">
          <h2>8️⃣ 고객 세그먼트 세부분석</h2>
          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              고객 세그먼트 분석 결과, **주택/빌라/원룸 거주자 (CTR 1.79%)**가
              가장 높은 성과를 기록하였으며, 이는 캠페인 평균(1.56%) 대비
              **1.15배** 높은 수치입니다. 라이프스테이지별로는 **유치원생 부모
              (CTR 1.77%)** 그룹이 두 번째로 높은 효율을 보였습니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              **주택/빌라/원룸** 거주자의 높은 CTR은 (1) **1~2인 가구 비율**이
              높아 배달 서비스 의존도가 높고, (2) 상대적으로 **외식/배달에 대한
              니즈**가 높기 때문으로 분석됩니다. **유치원생 부모**의 높은 CTR은
              (1) **육아로 인한 시간 부족**으로 간편한 외식 옵션을 선호하며, (2)
              **자녀를 위한 식사 구매 니즈**가 높기 때문으로 해석됩니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              **주택/빌라/원룸 거주자**에게는 **1인 가구 맞춤 특가** 및 **배달
              편의성**을 강조하는 메시징을 적용하고, **유치원생 부모**에게는
              **가족 세트 제안** 및 **어린이 메뉴 프로모션**을 제공해야 합니다.
              모수가 적거나 효율이 낮은 세그먼트(예: 고등학생)에 대한 예산은
              고효율 세그먼트로 재배치하는 것이 바람직합니다.
            </p>
          </div>

          <div
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
              gap: 20px;
              margin: 30px 0;
            "
          >
            <div class="chart-container">
              <div
                id="chart-s8-residence"
                class="plotly-data"
                data-graph='{"data":[{"x":["주택/빌라/원룸","기타","아파트","오피스텔","알수없음"],"y":[1.7917788968263262,1.6403785488958993,1.5276412311880814,1.4577259475218658,1.452604134334844],"type":"bar","marker":{"color":"#F77F00"},"text":["1.79%","1.64%","1.53%","1.46%","1.45%"],"textposition":"outside","opacity":0.9}],"layout":{"title":{"text":"<b>거주 형태별 CTR (Sent ≥ 100 기준)</b>","font":{"size":14}},"xaxis":{"tickangle":-35,"automargin":true},"yaxis":{"title":"CTR (%)","range":[0,3]},"plot_bgcolor":"#F8F9FA","paper_bgcolor":"white","autosize":true,"margin":{"t":50,"b":120},"shapes":[{"type":"line","xref":"paper","yref":"y","x0":0,"y0":1.56,"x1":1,"y1":1.56,"line":{"dash":"dash","color":"gray","width":2}}]}'
              ></div>
            </div>

            <div class="chart-container">
              <div
                id="chart-s8-stage"
                class="plotly-data"
                data-graph='{"data":[{"x":["유치원생 부모","고등학생 부모","유아 부모"],"y":[1.7650639074863057,1.5274949083503055,1.439736733854381],"type":"bar","marker":{"color":"#F77F00"},"text":["1.77%","1.53%","1.44%"],"textposition":"outside","opacity":0.9}],"layout":{"title":{"text":"<b>라이프스테이지별 CTR (Sent ≥ 100 기준)</b>","font":{"size":14}},"xaxis":{"tickangle":-35,"automargin":true},"yaxis":{"title":"CTR (%)","range":[0,3]},"plot_bgcolor":"#F8F9FA","paper_bgcolor":"white","autosize":true,"margin":{"t":50,"b":120},"shapes":[{"type":"line","xref":"paper","yref":"y","x0":0,"y0":1.56,"x1":1,"y1":1.56,"line":{"dash":"dash","color":"gray","width":2}}]}'
              ></div>
            </div>
          </div>
        </div>

        <div class="section" id="s9">
          <h2>9️⃣ 지역별 사용 행태 분석</h2>

          <div class="chart-container">
            <div
              id="chart-s9"
              class="plotly-data"
              data-graph='{"data":[{"x":["전남","경기","강원","서울","경남"],"y":[1.8275862068965518,1.630083925112976,1.5245354930919486,1.452689438555163,1.215443279313632],"type":"bar","marker":{"color":"#F77F00"},"text":["1.83%","1.63%","1.52%","1.45%","1.22%"],"textposition":"outside","opacity":0.9}],"layout":{"title":{"text":"<b>시도별 CTR 분포 (Sent ≥ 1000 기준)</b>","font":{"size":16}},"xaxis":{"tickangle":-35,"automargin":true},"yaxis":{"title":"CTR (%)","range":[0,3]},"plot_bgcolor":"#F8F9FA","paper_bgcolor":"white","autosize":true,"margin":{"t":50,"b":120},"shapes":[{"type":"line","xref":"paper","yref":"y","x0":0,"y0":1.56,"x1":1,"y1":1.56,"line":{"dash":"dash","color":"gray","width":2}}]}'
            ></div>
          </div>

          <div class="insight-box">
            <h4>💡 What (발견 사항)</h4>
            <p>
              시도별 분석 결과, <strong>수도권 타겟</strong>인 **경기 지역 (CTR
              1.63%)**이 캠페인 평균(1.56%) 대비 **1.04배** 높은 성과를
              기록하였으며, **서울 (1.45%)**은 평균보다 낮은 CTR을 보였습니다.
              수도권 외 지역 중 **전남 (1.83%)**, **강원 (1.52%)**이 높은 성과를
              보였습니다.
            </p>

            <h4>🔍 Why (원인 분석)</h4>
            <p>
              <strong>수도권(서울, 경기)</strong> 타겟에서 경기가 서울보다 높은
              CTR을 보인 것은 (1) 20-39세 남녀 타겟의 높은 집중도로 인한 디지털
              서비스 이용 빈도가 높고, (2) 경기 신도시 지역의 젊은 가구 비율이
              높아 배달 서비스 의존도가 더 높기 때문으로 분석됩니다. 서울의 낮은
              CTR은 (1) **높은 경쟁 환경**과 (2) **다양한 외식 옵션** 때문일 수
              있습니다.
            </p>

            <h4>🚀 So What (전략적 시사점)</h4>
            <p>
              <strong>수도권(서울, 경기)</strong> 타겟에 대해서는 지역 특화 배달
              프로모션 및 시간대별(점심/저녁/야식) 맞춤형 메시징을 강화하여
              전환율을 높여야 합니다. 특히 경기 지역의 높은 잠재력을 활용하여
              신도시 중심의 집중 타겟팅을 실행하고, 서울 지역에 대해서는 경쟁
              브랜드 대비 차별화된 혜택을 강조하는 메시지를 적용해야 합니다.
              수도권 외 고효율 지역(전남 등)에 대해서도 유사한 전략을 확대
              적용하는 것을 권장합니다.
            </p>
          </div>
        </div>

        <div class="section" id="strategy">
          <h2>🎯 핵심 전략 제언</h2>
          <div class="strategy-box">
            <h3>1. 20-39세 남녀 & 수도권 타겟팅 초세분화 전략</h3>
            <ul>
              <li>
                <strong>근거:</strong> <strong>20-39세 남녀 타겟</strong> 내에서
                **남성 30-34세 (CTR 2.07%)**가 최고 성과를 기록하였으며, **여성
                30-34세 (1.82%)**, **남성 35-39세 (1.52%)** 등이 모두 평균 대비
                높은 효율을 보였습니다.
                <strong>수도권(경기 1.63%, 서울 1.45%)</strong> 타겟에서도
                안정적인 성과를 기록했습니다.
              </li>
              <li>
                <strong>실행 방안:</strong> <strong>20-39세 남녀</strong> 중
                특히 30대 세그먼트를 핵심 'Gold Target'으로 설정하고,
                <strong>수도권(서울, 경기)</strong> 지역에 집중하여 **구매력과
                가족 단위 소비**에 맞춘 **'고할인율 세트 메뉴'** 또는 **'배달비
                무료'** 혜택을 강조하여 전환율을 극대화합니다. 전체 예산의 **60%
                이상**을 <strong>20-39세 남녀 + 수도권</strong> 교집합
                세그먼트에 재배치합니다.
              </li>
            </ul>

            <h3>2. 경쟁 플랫폼 사용자 대상 교차 타겟팅 강화 전략</h3>
            <ul>
              <li>
                <strong>근거:</strong> **쿠팡이츠 (CTR 1.97%)** 및 **팔도감 (CTR
                1.84%)** 사용자들이 평균 대비 높은 효율을 보였으며, 이들은
                할인에 민감하고 플랫폼 전환 의향이 높은 것으로 분석됩니다.
              </li>
              <li>
                <strong>실행 방안:</strong> 이들에게 '**타 플랫폼 대비 최대
                할인**', '**요기요 단독 특가**' 등의 **경쟁 우위 메시지**를
                적용하여 플랫폼 전환을 적극적으로 유도하고, **즉시 구매 유도
                푸시**와 연계된 제안을 강화합니다.
              </li>
            </ul>

            <h3>3. 수도권 지역 특화 메시지 최적화 전략</h3>
            <ul>
              <li>
                <strong>근거:</strong>
                <strong>수도권(서울, 경기)</strong> 타겟에서 경기(CTR 1.63%)가
                서울(1.45%)보다 높은 성과를 보였으며, 특히 경기 지역의 신도시
                특성상 20-39세 젊은 가구 비율이 높아 배달 서비스 의존도가
                높습니다.
              </li>
              <li>
                <strong>실행 방안:</strong> <strong>수도권(서울, 경기)</strong>
                타겟에게는 지역 특화 배달 프로모션 및 시간대별(점심/저녁/야식)
                맞춤형 메시징을 제공합니다. 특히 경기 신도시 지역의 20-39세
                가구에게는 패밀리 세트 할인을, 서울 지역에는 경쟁 브랜드 대비
                차별화된 혜택을 강조하는 메시지를 발송합니다.
              </li>
            </ul>
          </div>
        </div>

        <div class="footer">
          <p>
            본 보고서는 데이터 분석을 기반으로 작성되었으며, 전략적 의사결정에
            참고 자료로 활용될 수 있습니다.
          </p>
          <p>&copy; 2025 Marketing Report | All Rights Reserved.</p>
        </div>
      </div>
    </div>

    <!-- Render Plotly graphs safely + responsive handling -->
    <script>
      (function () {
        // debounce helper
        function debounce(func, wait) {
          let timeout;
          return function () {
            const context = this,
              args = arguments;
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(context, args), wait);
          };
        }

        // safely parse JSON-ish attribute (data-graph)
        function safeParseGraph(dataAttr) {
          try {
            return JSON.parse(dataAttr);
          } catch (e) {
            // try to sanitize (replace single quotes with double quotes) as fallback
            try {
              const sanitized = dataAttr.replace(/(\r\n|\n|\r)/gm, "");
              return JSON.parse(sanitized);
            } catch (e2) {
              console.error("Failed to parse data-graph:", e2);
              return null;
            }
          }
        }

        // Ensure each .plotly-data has an id
        function ensureIds() {
          document.querySelectorAll(".plotly-data").forEach((el, idx) => {
            if (!el.id) el.id = "plotly-auto-" + idx;
          });
        }

        // Render specific charts directly (to avoid JSON parsing issues)
        function renderDirectCharts() {
          const BASELINE_CTR = 1.56;

          // chart-s2: 주요 세그먼트 성과 비교
          if (document.getElementById("chart-s2")) {
            const chartS2Data = [
              {
                x: [
                  "남성 30-34",
                  "남성 45-49",
                  "여성 30-34",
                  "여성 45-49",
                  "여성 40-44",
                  "여성 35-39",
                  "남성 35-39",
                  "여성 25-29",
                  "남성 25-29",
                  "여성 20-24",
                  "남성 20-24",
                ],
                y: [
                  2.07, 1.83, 1.82, 1.8, 1.79, 1.71, 1.52, 1.39, 1.38, 0.77,
                  0.62,
                ],
                type: "bar",
                marker: { color: "#F77F00" },
                text: [
                  "2.07%",
                  "1.83%",
                  "1.82%",
                  "1.80%",
                  "1.79%",
                  "1.71%",
                  "1.52%",
                  "1.39%",
                  "1.38%",
                  "0.77%",
                  "0.62%",
                ],
                textposition: "outside",
                opacity: 0.9,
              },
            ];
            const chartS2Layout = {
              title: {
                text: "<b>주요 성연령별 CTR 비교 (Sent ≥ 5,000 기준)</b>",
                font: { size: 16 },
              },
              xaxis: { tickangle: -40, automargin: true },
              yaxis: { title: "CTR (%)", range: [0, 3] },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot("chart-s2", chartS2Data, chartS2Layout, {
              responsive: true,
            });
          }

          // chart-s3: 앱 카테고리별 성과 분석
          if (document.getElementById("chart-s3")) {
            const chartS3Data = [
              {
                x: ["Information", "Communication", "Entertainment"],
                y: [39615, 39668, 39774],
                name: "발송 건수",
                type: "bar",
                marker: { color: "#2E86AB" },
                text: ["39,615건", "39,668건", "39,774건"],
                textposition: "outside",
              },
              {
                x: ["Information", "Communication", "Entertainment"],
                y: [1.587829887661772, 1.590758394625894, 1.5789209031025293],
                name: "CTR",
                type: "scatter",
                mode: "lines+markers",
                marker: { color: "#F77F00", size: 8 },
                yaxis: "y2",
                text: ["1.59%", "1.59%", "1.58%"],
                textposition: "top",
              },
            ];
            const chartS3Layout = {
              title: {
                text: "<b>앱 카테고리별: 발송 vs CTR (Sent ≥ 100 기준)</b>",
                font: { size: 16 },
              },
              xaxis: { tickangle: -35, automargin: true },
              yaxis: { title: "발송 건수", titlefont: { color: "#2E86AB" } },
              yaxis2: {
                title: "CTR (%)",
                titlefont: { color: "#F77F00" },
                overlaying: "y",
                side: "right",
                range: [0, 5],
              },
              legend: { orientation: "h", y: -0.25 },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y2",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot("chart-s3", chartS3Data, chartS3Layout, {
              responsive: true,
            });
          }

          // chart-s4: 상세 앱/플랫폼 CTR 분석
          if (document.getElementById("chart-s4")) {
            const chartS4Data = [
              {
                x: [
                  "쿠팡이츠(CoupangEats)",
                  "팔도감(Paldogam)",
                  "롯데잇츠(Lotteeatz)",
                  "배민상회(BaeminMart)",
                  "배달의민족(Baemin)",
                ],
                y: [
                  1.9679527069072806, 1.8354860639021073, 1.7801178387865113,
                  1.6913847692051325, 1.579961464354528,
                ],
                type: "bar",
                marker: { color: "#F77F00" },
                text: ["1.97%", "1.84%", "1.78%", "1.69%", "1.58%"],
                textposition: "outside",
                opacity: 0.9,
              },
            ];
            const chartS4Layout = {
              title: {
                text: "<b>Food/Delivery 앱 CTR Top 5 (Sent ≥ 100 기준)</b>",
                font: { size: 16 },
              },
              xaxis: { tickangle: -35, automargin: true },
              yaxis: { title: "CTR (%)", range: [0, 3] },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot("chart-s4", chartS4Data, chartS4Layout, {
              responsive: true,
            });
          }

          // chart-s5: 성연령별 성과 분석
          if (document.getElementById("chart-s5")) {
            const chartS5Data = [
              {
                x: ["20-24", "25-29", "30-34", "35-39", "40-44", "45-49"],
                y: [0.62, 1.39, 2.07, 1.52, 1.3, 1.83],
                name: "남성",
                type: "bar",
                marker: { color: "#2E86AB" },
              },
              {
                x: ["20-24", "25-29", "30-34", "35-39", "40-44", "45-49"],
                y: [0.77, 1.39, 1.82, 1.71, 1.45, 1.8],
                name: "여성",
                type: "bar",
                marker: { color: "#06A77D" },
              },
            ];
            const chartS5Layout = {
              title: {
                text: "<b>성연령별 CTR 분포 (Sent ≥ 5,000 기준)</b>",
                font: { size: 16 },
              },
              barmode: "group",
              xaxis: { tickangle: -35, automargin: true },
              yaxis: { title: "CTR (%)", range: [0, 3] },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot("chart-s5", chartS5Data, chartS5Layout, {
              responsive: true,
            });
          }

          // chart-s6: 관심사별 행동 패턴
          if (document.getElementById("chart-s6")) {
            const chartS6Data = [
              {
                x: ["Information", "Communication", "Entertainment"],
                y: [1.587829887661772, 1.590758394625894, 1.5789209031025293],
                type: "bar",
                marker: { color: "#F77F00" },
                text: ["1.59%", "1.59%", "1.58%"],
                textposition: "outside",
                opacity: 0.9,
              },
            ];
            const chartS6Layout = {
              title: {
                text: "<b>관심사(App Cat1)별 CTR (Sent ≥ 100 기준)</b>",
                font: { size: 16 },
              },
              xaxis: { tickangle: -35, automargin: true },
              yaxis: { title: "CTR (%)", range: [0, 3] },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot("chart-s6", chartS6Data, chartS6Layout, {
              responsive: true,
            });
          }

          // chart-s7: 음식/배달 앱별 CTR 심층분석
          if (document.getElementById("chart-s7")) {
            const chartS7Data = [
              {
                x: [
                  "쿠팡이츠(CoupangEats)",
                  "팔도감(Paldogam)",
                  "롯데잇츠(Lotteeatz)",
                  "배민상회(BaeminMart)",
                  "배달의민족(Baemin)",
                  "비비노(Vivino) Web",
                ],
                y: [
                  1.9679527069072806, 1.8354860639021073, 1.7801178387865113,
                  1.6913847692051325, 1.579961464354528, 1.5384615384615385,
                ],
                type: "bar",
                marker: { color: "#F77F00" },
                text: ["1.97%", "1.84%", "1.78%", "1.69%", "1.58%", "1.54%"],
                textposition: "outside",
                opacity: 0.9,
              },
            ];
            const chartS7Layout = {
              title: {
                text: "<b>음식/배달 앱별 CTR 심층분석 (Sent ≥ 100 기준)</b>",
                font: { size: 16 },
              },
              xaxis: { tickangle: -35, automargin: true },
              yaxis: { title: "CTR (%)", range: [0, 3] },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot("chart-s7", chartS7Data, chartS7Layout, {
              responsive: true,
            });
          }

          // chart-s8-residence: 거주 형태별 CTR
          if (document.getElementById("chart-s8-residence")) {
            const chartS8ResData = [
              {
                x: ["주택/빌라/원룸", "기타", "아파트", "오피스텔", "알수없음"],
                y: [
                  1.7917788968263262, 1.6403785488958993, 1.5276412311880814,
                  1.4577259475218658, 1.452604134334844,
                ],
                type: "bar",
                marker: { color: "#F77F00" },
                text: ["1.79%", "1.64%", "1.53%", "1.46%", "1.45%"],
                textposition: "outside",
                opacity: 0.9,
              },
            ];
            const chartS8ResLayout = {
              title: {
                text: "<b>거주 형태별 CTR (Sent ≥ 100 기준)</b>",
                font: { size: 14 },
              },
              xaxis: { tickangle: -35, automargin: true },
              yaxis: { title: "CTR (%)", range: [0, 3] },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot(
              "chart-s8-residence",
              chartS8ResData,
              chartS8ResLayout,
              { responsive: true }
            );
          }

          // chart-s8-stage: 라이프스테이지별 CTR
          if (document.getElementById("chart-s8-stage")) {
            const chartS8StageData = [
              {
                x: ["유치원생 부모", "고등학생 부모", "유아 부모"],
                y: [1.7650639074863057, 1.5274949083503055, 1.439736733854381],
                type: "bar",
                marker: { color: "#F77F00" },
                text: ["1.77%", "1.53%", "1.44%"],
                textposition: "outside",
                opacity: 0.9,
              },
            ];
            const chartS8StageLayout = {
              title: {
                text: "<b>라이프스테이지별 CTR (Sent ≥ 100 기준)</b>",
                font: { size: 14 },
              },
              xaxis: { tickangle: -35, automargin: true },
              yaxis: { title: "CTR (%)", range: [0, 3] },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot(
              "chart-s8-stage",
              chartS8StageData,
              chartS8StageLayout,
              { responsive: true }
            );
          }

          // chart-s9: 시도별 CTR 분포
          if (document.getElementById("chart-s9")) {
            const chartS9Data = [
              {
                x: ["전남", "경기", "강원", "서울", "경남"],
                y: [
                  1.8275862068965518, 1.630083925112976, 1.5245354930919486,
                  1.452689438555163, 1.215443279313632,
                ],
                type: "bar",
                marker: { color: "#F77F00" },
                text: ["1.83%", "1.63%", "1.52%", "1.45%", "1.22%"],
                textposition: "outside",
                opacity: 0.9,
              },
            ];
            const chartS9Layout = {
              title: {
                text: "<b>시도별 CTR 분포 (Sent ≥ 1000 기준)</b>",
                font: { size: 16 },
              },
              xaxis: { tickangle: -35, automargin: true },
              yaxis: { title: "CTR (%)", range: [0, 3] },
              plot_bgcolor: "#F8F9FA",
              paper_bgcolor: "white",
              autosize: true,
              margin: { t: 50, b: 120 },
              shapes: [
                {
                  type: "line",
                  xref: "paper",
                  yref: "y",
                  x0: 0,
                  y0: BASELINE_CTR,
                  x1: 1,
                  y1: BASELINE_CTR,
                  line: { dash: "dash", color: "gray", width: 2 },
                },
              ],
            };
            Plotly.newPlot("chart-s9", chartS9Data, chartS9Layout, {
              responsive: true,
            });
          }
        }

        // Render all graphs
        function renderAllPlots() {
          ensureIds();

          // Render direct charts first (to avoid JSON parsing issues)
          renderDirectCharts();

          const charts = document.querySelectorAll(".plotly-data");
          console.log("Found " + charts.length + " chart containers");

          charts.forEach((el, index) => {
            const id = el.id;

            // Skip charts that are rendered directly
            if (
              id === "chart-s2" ||
              id === "chart-s3" ||
              id === "chart-s4" ||
              id === "chart-s5" ||
              id === "chart-s6" ||
              id === "chart-s7" ||
              id === "chart-s8-residence" ||
              id === "chart-s8-stage" ||
              id === "chart-s9"
            ) {
              return;
            }

            const raw = el.getAttribute("data-graph") || el.dataset.graph;

            if (!raw) {
              console.error("No graph data for chart:", id);
              el.innerHTML =
                '<p class="text-red-500">No graph data provided.</p>';
              return;
            }

            const graph = safeParseGraph(raw);
            if (!graph) {
              console.error("Failed to parse graph data for:", id);
              el.innerHTML =
                '<p class="text-red-500">데이터 파싱 오류: 시각화 불가</p>';
              return;
            }

            // Ensure layout exists and is autosize-friendly
            graph.layout = graph.layout || {};
            graph.layout.autosize = true;
            graph.layout.margin = graph.layout.margin || {
              t: 50,
              b: 120,
              l: 60,
              r: 60,
            };
            graph.layout.font = graph.layout.font || {
              family: "Nanum Gothic, sans-serif",
            };

            // Ensure container has minimum height
            if (!el.style.minHeight) {
              el.style.minHeight = "400px";
            }

            const config = {
              responsive: true,
              displayModeBar: true,
              displaylogo: false,
              toImageButtonOptions: {
                format: "png",
                filename: "chart",
                height: 800,
                width: 1200,
              },
            };

            try {
              console.log("Rendering chart:", id);
              Plotly.newPlot(id, graph.data, graph.layout, config)
                .then(() => {
                  console.log("Chart rendered successfully:", id);
                  // after initial draw, ensure annotations/text fully visible by expanding margins if necessary
                  try {
                    Plotly.Plots.resize(document.getElementById(id));
                  } catch (e) {
                    console.warn("Resize error for", id, e);
                  }
                })
                .catch((err) => {
                  console.error("Plotly promise error for", id, err);
                  el.innerHTML =
                    '<p class="text-red-500">차트 렌더링 실패: ' +
                    err.message +
                    "</p>";
                });
            } catch (e) {
              console.error("Plotly render error for", id, ":", e);
              el.innerHTML =
                '<p class="text-red-500">데이터 시각화 중 오류가 발생했습니다: ' +
                e.message +
                "</p>";
            }
          });
        }

        // Wait for Plotly to load, then render
        function initCharts() {
          if (typeof Plotly === "undefined") {
            console.log("Waiting for Plotly to load...");
            setTimeout(initCharts, 100);
            return;
          }
          console.log("Plotly loaded, rendering charts...");
          renderAllPlots();
        }

        // Wait for both DOM and Plotly to be ready
        window.addEventListener("load", function () {
          initCharts();
        });

        // Fallback: if window.load already fired, try immediately
        if (document.readyState === "complete") {
          initCharts();
        }

        // Window resize: debounce Plotly resize for performance
        window.addEventListener(
          "resize",
          debounce(function () {
            document.querySelectorAll(".plotly-graph-div").forEach((g) => {
              try {
                Plotly.Plots.resize(g);
              } catch (e) {
                /* ignore */
              }
            });
          }, 150)
        );

        // Optional: re-render when user focuses back (handles some mobile reflow cases)
        window.addEventListener("focus", function () {
          try {
            document
              .querySelectorAll(".plotly-graph-div")
              .forEach((g) => Plotly.Plots.resize(g));
          } catch (e) {}
        });
      })();
    </script>
  </body>
</html>
